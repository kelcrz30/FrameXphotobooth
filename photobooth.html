<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRAMEX</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Koulen&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kreon:wght@300..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=light_mode" />
</head>
<body class="photobooth">
    <div class="boot">
        <main class="content-container">
            
            
            <div class="tab-container">
                <div class="tab-buttons">
                  <button class="tab-button active" id="cameraTab" onclick="switchTab('camera')">Camera</button>
                  <button class="tab-button" id="uploadTab" onclick="switchTab('upload')">Upload</button>
                  </div>
                </div>
              
                
            
            <div class="left-section">
                
                <div class="video-container" id="cameraTabContent">
                    <div id="countdownText"></div>  <!-- Move this inside video-container -->
                    <label class="select-camera" for="cameraSelect">Select Camera:</label>
                    <select id="cameraSelect"></select>
                    <video id="video" playsinline="true" autoplay muted webkit-playsinline="true" style="width: 100%; height: auto; background: #000;"></video>
                </div>
                <div id="ios-prompt" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(235, 0, 0, 0.7); color: rgb(131, 84, 84); padding: 15px; border-radius: 10px; text-align: center;">
                    Tap to activate camera
                </div>
                <div class="upload-container" id="uploadTabContent">
                    <!-- Upload content goes here -->
                    <div id="upload-placeholder">
                        <div style="font-size: 24px; margin-bottom: 15px;">ðŸ“· Click "Upload Photo" to select images</div>
                        <div id="upload-preview" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;"></div>
                    </div>
                </div>
                
                <div class="controls">
                   <div class="button-element">
                    <button id="captureBtn">Capture</button>
                    <div class="uploadbtn1"></div>
                    
                 
                </div> 

                    <div class="checkbox-wrapper-12">
                       <div class="filter-container">
                        <div class="cbx" onclick="toggleMirror()">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f">
                                <path d="M480-240q79 0 136-53.5T678-426l30 28 42-42-100-100-100 100 42 42 26-26q-6 53-45 88.5T480-300q-13 0-25.5-2.5T430-310l-44 44q22 12 45.5 19t48.5 7ZM310-340l100-100-42-42-26 26q6-53 45-88.5t93-35.5q13 0 25.5 2.5T530-570l44-44q-22-12-45.5-19t-48.5-7q-79 0-136 53.5T282-454l-30-28-42 42 100 100ZM160-120q-33 0-56.5-23.5T80-200v-480q0-33 23.5-56.5T160-760h126l74-80h240l74 80h126q33 0 56.5 23.5T880-680v480q0 33-23.5 56.5T800-120H160Zm0-80h640v-480H638l-73-80H395l-73 80H160v480Zm320-240Z"/>
                            </svg>
                        </div>
                        <div class="icon-container" onclick="toggleSlider('brightness')">
                            <span class="material-symbols-outlined">light_mode</span>
                            <input type="range" id="brightness" min="50" max="200" value="100" style="display: none;">
                        </div>
                        
                        <!-- Contrast Toggle -->
                        <div class="control-container" onclick="toggleSlider('contrast')">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f">
                                <path d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm40-83q119-15 199.5-104.5T800-480q0-123-80.5-212.5T520-797v634Z"/>
                            </svg>
                            <input type="range" id="contrast" class="slider" min="50" max="200" value="100" style="display: none;">
                        </div>
                        
                        <div class="filter-control">
                            <button id="filterSelect" class="filter-button" aria-label="Photo Filters">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f">
                                    <path d="M440-160q-17 0-28.5-11.5T400-200v-240L168-736q-15-20-4.5-42t36.5-22h560q26 0 36.5 22t-4.5 42L560-440v240q0 17-11.5 28.5T520-160h-80Zm40-308 198-252H282l198 252Zm0 0Z"/>
                                </svg>
                            </button>
                        </div>
                        
                    <label class="selectTimer" for="timerSelect" style="font-family: Arial, sans-serif;">Timer:</label>
                    <select id="timerSelect">
                        <option value="0">No Timer</option>
                        <option value="3">3s</option>
                        <option value="5">5s</option>
                        <option value="10">10s</option>
                    </select>
                   </div> 


         <p id="countdownDisplay"></p>
                        
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
                          <defs>
                            <filter id="goo-12">
                              <feGaussianBlur result="blur" stdDeviation="4" in="SourceGraphic"></feGaussianBlur>
                              <feColorMatrix result="goo-12" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 22 -7" mode="matrix" in="blur"></feColorMatrix>
                              <feBlend in2="goo-12" in="SourceGraphic"></feBlend>
                            </filter>
                          </defs>
                        </svg>
                      </div>
                    <p id="counterText">Photos Taken: 0 / 4</p>
                  
                </div>
            </div>
            <div class="right-section">
                <div class="photo-stack">
                    <canvas id="canvas1"></canvas>
                    <canvas id="canvas2"></canvas>
                    <canvas id="canvas3"></canvas>
                    <canvas id="canvas4"></canvas>
                </div>
                <div class="nextbtn">
                    <a href="edit.html">
                        <button id="nextPageBtn" style="display: none;">Next page</button>
                    </a>
                </div>
            </div>
        </main>
        

    </div>

    <script src="darkmode.js"></script>
    <script src="app.js" defer></script>

    <script>
        
        document.addEventListener("DOMContentLoaded", () => {
    setupFilterDropdown();
});

function setupFilterDropdown() {
    const filterSelect = document.getElementById("filterSelect");
    if (!filterSelect) {
        console.warn("Filter button not found");
        return;
    }

    const dropdown = document.createElement('div');
    dropdown.id = 'filterDropdown';
    dropdown.style.position = 'absolute';
    dropdown.style.display = 'none';
    dropdown.style.background = '#fff';
    dropdown.style.border = '1px solid #ccc';
    dropdown.style.padding = '5px';
    dropdown.style.zIndex = '1000';

    const filters = ['None', 'Grayscale', 'Sepia', 'Invert'];
    filters.forEach(filter => {
        const option = document.createElement('div');
        option.textContent = filter;
        option.style.cursor = 'pointer';
        option.onclick = () => {
            console.log("Filter selected:", filter);
            dropdown.style.display = 'none';
            // Apply filter logic here
        };
        dropdown.appendChild(option);
    });

    document.body.appendChild(dropdown);

    filterSelect.addEventListener('click', (e) => {
        e.stopPropagation();
        const rect = filterSelect.getBoundingClientRect();
        dropdown.style.top = `${rect.bottom + window.scrollY}px`;
        dropdown.style.left = `${rect.left + window.scrollX}px`;
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });

    document.addEventListener('click', () => {
        dropdown.style.display = 'none';
    });
}
        function switchTab(tabName) {
    // Hide all tab contents
    document.getElementById('cameraTabContent').style.display = 'none';
    document.getElementById('uploadTabContent').style.display = 'none';
    
    // Show/hide controls based on tab
    const controls = document.querySelector('.controls');
    
    if (tabName === 'camera') {
        document.getElementById('cameraTabContent').style.display = 'block';
        
        // Show camera controls
        if (controls) controls.style.display = 'block';

        const videoElement = document.getElementById('video');
        if (videoElement) {
            videoElement.style.display = 'block';
        }
        const uploadBtn = document.getElementById('uploadBtn');
        
        
        // Reset upload mode if needed
        if (typeof isUploadMode !== 'undefined') {
            isUploadMode = false;
        }
        
        // Re-enable capture button
        const captureBtn = document.getElementById('captureBtn');
        if (captureBtn) {
            captureBtn.disabled = false;
        }
    } else if (tabName === 'upload') {
        document.getElementById('uploadTabContent').style.display = 'block';
        
        // Hide camera controls
        if (controls) controls.style.display = 'none';
        
        // Create "Choose Files" button if it doesn't exist
        let chooseFilesBtn = document.getElementById('chooseFilesBtn');
        if (!chooseFilesBtn) {
            chooseFilesBtn = document.createElement('button');
            chooseFilesBtn.id = 'chooseFilesBtn';
            chooseFilesBtn.className = 'btn';
            chooseFilesBtn.textContent = 'Choose Photos';
            chooseFilesBtn.onclick = function() {
                const fileInput = document.getElementById('photoFileInput');
                if (fileInput) {
                    fileInput.click();
                }
            };
            
            const uploadTabContent = document.getElementById('uploadTabContent');
            if (uploadTabContent) {
                uploadTabContent.appendChild(chooseFilesBtn);
            }
        } else {
            chooseFilesBtn.style.display = 'block';
        }
    }
    
    // Update the active tab styling
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
    });
    document.getElementById(tabName + 'Tab').classList.add('active');
}


// Ensure upload button appears properly
document.addEventListener('DOMContentLoaded', function() {
    // Set camera tab as default active tab
    switchTab('camera');
    
    // Make sure the upload button is properly initialized
    const uploadBtn = document.getElementById('uploadBtn');
    if (!uploadBtn) {

        
        // Create the upload button if it doesn't exist
        const uploadBtn = document.createElement('button');
        uploadBtn.id = 'uploadBtn';
        uploadBtn.className = 'btn';
        uploadBtn.textContent = 'Upload Photo';
        
        // Add event listener
        uploadBtn.addEventListener('click', handleUploadBtnClick);
        
        // Find a good place to add the button (adjust as needed)
        const videoContainer = document.getElementById('cameraTabContent');
        if (videoContainer) {
            videoContainer.appendChild(uploadBtn);
        }
    }
    
    // Make sure the file input exists
    let photoFileInput = document.getElementById('photoFileInput');
    if (!photoFileInput) {
        console.log('Creating file input element');
        photoFileInput = document.createElement('input');
        photoFileInput.type = 'file';
        photoFileInput.multiple = true;
        photoFileInput.accept = 'image/*';
        photoFileInput.style.display = 'none';
        photoFileInput.id = 'photoFileInput';
        document.body.appendChild(photoFileInput);
        
        // Add event listener for file selection
        photoFileInput.addEventListener('change', handleFileSelection);
    }
});


// We should also make sure this modified version of handleUploadBtnClick exists
function handleUploadBtnClick() {
    const photoFileInput = document.getElementById('photoFileInput');
    if (photoFileInput) {
        photoFileInput.value = ''; // Clear any previous selection
        photoFileInput.click();
    } else {
        console.error('Photo file input not found!');
    }
}

    </script>
</body>
</html>